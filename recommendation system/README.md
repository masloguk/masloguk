Документация по рекомендательной системе.

Суть рекомендательной системы: рекомендательная система предсказывает какой товар пользователь скорее всего захочет просмотреть, на основании просмотров похожих пользователей.

Изначальный датасет состоит из следующих переменных:
- дата совершенного действия («timestamp»), формат int64
- номер пользователя («visitorid»), формат int64
- тип совершенного действия («event»), формат object
- номер товара («itemid»), формат int64
- стоимость купленного товара («transactionid»), формат float64

Для улучшения качества модели были отсеяны пользователи, которые редко посещают интернет-магазин (были на сайте меньше 30 раз).

В датасете были проведены трансформации:
- в переменной «event» перекодированы значения на формат int64: просмотр товара: 1, добавить товар: 2, совершить транзакицю: 3
- создан новый столбец, в котором будут только те строчки, которые означают, что покупатель либо добавил товар, либо купил («event_value»).

Далее использовались для построения рекомендательной системы следующие данные (в формате матрицы):
- номер пользователя («visitorid»), формат int64
- номер товара («itemid»), формат int64
- отметка о просмотре товара (“event”, на основании которой построена переменная “event_value”) на сайте (просмотр – 1, нет просмотра - 0), формат int64.

Исходный датасет был расположен по временному принципу, потом разделен на две части: обучающая выборка (80%), тестовая выборка (20%), без перемешивания (shuffle=false).

Обе матрицы переведены в формат разреженной матрицы.

Тестировались две модели рекомендательной системы:
- AlternatingLeastSquares
- LightFM

Наиболее высокую метрику дает LightFM со следующими гиперпараметрами:
- no_components=150
- loss='warp',
- learning_rate=0.05,
- learning_schedule="adadelta".

На тестовой выборке получена метрика «Mean Average Precision at 3: 0.075».

Построен докер-образ, который можно поднять по ссылке: docker pull masloguk86/rs

Для проверки работы рекомендательной системы можно использовать реальных «visitorid»: номера 172, 1014, 1722, 1879, 2019.
